2025-04-08 11:51:11,195 - db_manager - ERROR - 数据库连接池创建失败: connection was closed in the middle of operation
2025-04-08 11:52:29,839 - db_manager - INFO - 数据库连接池创建成功
2025-04-08 11:52:30,478 - task.stock_daily - INFO - Tushare API初始化成功
2025-04-08 11:52:30,478 - task.stock_daily_basic - INFO - Tushare API初始化成功
2025-04-08 11:52:30,478 - task.index_daily - INFO - Tushare API初始化成功
2025-04-08 11:52:30,479 - stock_data_example - INFO - 开始获取从 20250309 到 20250408 的数据
2025-04-08 11:52:30,479 - stock_data_example - INFO - 执行股票日线数据任务...
2025-04-08 11:52:30,479 - task.stock_daily - INFO - 开始执行任务: stock_daily
2025-04-08 11:52:30,479 - task.stock_daily - INFO - 准备执行股票日线数据任务...
2025-04-08 11:52:30,480 - task.stock_daily - INFO - 获取数据，日期范围: 20250309 至 20250408
2025-04-08 11:52:30,480 - task.stock_daily - INFO - 正在从Tushare获取数据，API: daily，参数: {'start_date': '20250309', 'end_date': '20250408', 'ts_code': '000001.SZ,000002.SZ,000063.SZ,000066.SZ,000333.SZ,000651.SZ,000858.SZ'}
2025-04-08 11:52:30,916 - task.stock_daily - INFO - 从Tushare获取到140条数据
2025-04-08 11:52:30,916 - task.stock_daily - INFO - 处理数据，共 140 行
2025-04-08 11:52:30,922 - task.stock_daily - INFO - 验证数据
2025-04-08 11:52:30,922 - task.stock_daily - INFO - 保存数据到表 stock_daily
2025-04-08 11:52:30,936 - task.stock_daily - INFO - 表 stock_daily 不存在，正在创建...
2025-04-08 11:52:30,952 - task.stock_daily - INFO - 表 stock_daily 创建成功
2025-04-08 11:52:30,954 - task.stock_daily - INFO - 为表 stock_daily 的 ts_code 列创建索引
2025-04-08 11:52:30,956 - task.stock_daily - INFO - 为表 stock_daily 的 trade_date 列创建索引
2025-04-08 11:52:30,964 - db_manager - ERROR - 批量SQL执行失败: 语法错误 在 "%" 或附近的
SQL: 
                INSERT INTO stock_daily (ts_code, trade_date, open, high, low, close, pre_close, change, pct_chg, vol, amount)
                VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
                ON CONFLICT (ts_code, trade_date) 
                DO UPDATE SET open = EXCLUDED.open, high = EXCLUDED.high, low = EXCLUDED.low, close = EXCLUDED.close, pre_close = EXCLUDED.pre_close, change = EXCLUDED.change, pct_chg = EXCLUDED.pct_chg, vol = EXCLUDED.vol, amount = EXCLUDED.amount;
                
2025-04-08 11:52:30,965 - task.stock_daily - ERROR - 任务执行失败: 语法错误 在 "%" 或附近的
Traceback (most recent call last):
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 58, in execute
    result = await self.save_data(data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 202, in save_data
    affected_rows = await self._save_to_database(data)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 337, in _save_to_database
    affected_rows = await self.db.executemany(upsert_sql, values)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\db_manager.py", line 141, in executemany
    stmt = await conn.prepare(query)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.PostgresSyntaxError: 语法错误 在 "%" 或附近的
2025-04-08 11:52:30,967 - stock_data_example - INFO - 股票日线数据任务执行结果: {'status': 'error', 'error': '语法错误 在 "%" 或附近的', 'task': 'stock_daily'}
2025-04-08 11:52:30,967 - stock_data_example - INFO - 执行股票基本面数据任务...
2025-04-08 11:52:30,967 - task.stock_daily_basic - INFO - 开始执行任务: stock_daily_basic
2025-04-08 11:52:30,967 - task.stock_daily_basic - INFO - 准备执行股票每日基本面指标任务...
2025-04-08 11:52:30,968 - task.stock_daily_basic - ERROR - 任务执行失败: 'StockDailyBasicTask' object has no attribute 'db_manager'
Traceback (most recent call last):
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 34, in execute
    await self.pre_execute()
  File "e:\CodePrograms\autoDatabase\data_module\tasks\stock\daily_basic.py", line 162, in pre_execute
    if self.db_manager and "stock_daily" in self.dependencies:
       ^^^^^^^^^^^^^^^
AttributeError: 'StockDailyBasicTask' object has no attribute 'db_manager'
2025-04-08 11:52:30,970 - stock_data_example - INFO - 股票基本面数据任务执行结果: {'status': 'error', 'error': "'StockDailyBasicTask' object has no attribute 'db_manager'", 'task': 'stock_daily_basic'}
2025-04-08 11:52:30,970 - stock_data_example - INFO - 执行指数日线数据任务...
2025-04-08 11:52:30,970 - task.index_daily - INFO - 开始执行任务: index_daily
2025-04-08 11:52:30,970 - task.index_daily - INFO - 准备执行指数日线数据任务...
2025-04-08 11:52:30,970 - task.index_daily - INFO - 获取数据，日期范围: 20250309 至 20250408
2025-04-08 11:52:30,971 - task.index_daily - INFO - 正在从Tushare获取数据，API: index_daily，参数: {'start_date': '20250309', 'end_date': '20250408', 'ts_code': '000001.SH,399001.SZ,399006.SZ'}
2025-04-08 11:52:31,273 - task.index_daily - INFO - 从Tushare获取到0条数据
2025-04-08 11:52:31,274 - task.index_daily - INFO - 没有获取到数据
2025-04-08 11:52:31,275 - stock_data_example - INFO - 指数日线数据任务执行结果: {'status': 'no_data', 'rows': 0}
2025-04-08 11:52:31,275 - stock_data_example - INFO - 执行股票日线数据增量更新...
2025-04-08 11:52:31,278 - task.stock_daily - INFO - 开始执行stock_daily的增量更新，日期范围: 20250401 至 20250408...
2025-04-08 11:52:31,279 - task.stock_daily - INFO - 开始执行任务: stock_daily
2025-04-08 11:52:31,279 - task.stock_daily - INFO - 准备执行股票日线数据任务...
2025-04-08 11:52:31,279 - task.stock_daily - INFO - 获取数据，日期范围: 20250401 至 20250408
2025-04-08 11:52:31,279 - task.stock_daily - INFO - 正在从Tushare获取数据，API: daily，参数: {'start_date': '20250401', 'end_date': '20250408', 'ts_code': '000001.SZ,000002.SZ,000063.SZ,000066.SZ,000333.SZ,000651.SZ,000858.SZ'}
2025-04-08 11:52:31,549 - task.stock_daily - INFO - 从Tushare获取到28条数据
2025-04-08 11:52:31,550 - task.stock_daily - INFO - 处理数据，共 28 行
2025-04-08 11:52:31,552 - task.stock_daily - INFO - 验证数据
2025-04-08 11:52:31,553 - task.stock_daily - INFO - 保存数据到表 stock_daily
2025-04-08 11:52:31,555 - db_manager - ERROR - 批量SQL执行失败: 语法错误 在 "%" 或附近的
SQL: 
                INSERT INTO stock_daily (ts_code, trade_date, open, high, low, close, pre_close, change, pct_chg, vol, amount)
                VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
                ON CONFLICT (ts_code, trade_date) 
                DO UPDATE SET open = EXCLUDED.open, high = EXCLUDED.high, low = EXCLUDED.low, close = EXCLUDED.close, pre_close = EXCLUDED.pre_close, change = EXCLUDED.change, pct_chg = EXCLUDED.pct_chg, vol = EXCLUDED.vol, amount = EXCLUDED.amount;
                
2025-04-08 11:52:31,555 - task.stock_daily - ERROR - 任务执行失败: 语法错误 在 "%" 或附近的
Traceback (most recent call last):
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 58, in execute
    result = await self.save_data(data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 202, in save_data
    affected_rows = await self._save_to_database(data)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 337, in _save_to_database
    affected_rows = await self.db.executemany(upsert_sql, values)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\db_manager.py", line 141, in executemany
    stmt = await conn.prepare(query)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.PostgresSyntaxError: 语法错误 在 "%" 或附近的
2025-04-08 11:52:31,557 - task.stock_daily - INFO - 增量更新完成: {'status': 'error', 'error': '语法错误 在 "%" 或附近的', 'task': 'stock_daily'}
2025-04-08 11:52:31,557 - stock_data_example - INFO - 股票日线数据增量更新结果: {'status': 'error', 'error': '语法错误 在 "%" 或附近的', 'task': 'stock_daily'}
2025-04-08 11:52:31,571 - db_manager - INFO - 数据库连接池已关闭
2025-04-08 11:52:50,917 - db_manager - INFO - 数据库连接池创建成功
2025-04-08 11:52:51,436 - task.stock_daily - INFO - Tushare API初始化成功
2025-04-08 11:52:51,436 - task.stock_daily_basic - INFO - Tushare API初始化成功
2025-04-08 11:52:51,436 - task.index_daily - INFO - Tushare API初始化成功
2025-04-08 11:52:51,437 - stock_data_example - INFO - 开始获取从 20250309 到 20250408 的数据
2025-04-08 11:52:51,437 - stock_data_example - INFO - 执行股票日线数据任务...
2025-04-08 11:52:51,437 - task.stock_daily - INFO - 开始执行任务: stock_daily
2025-04-08 11:52:51,437 - task.stock_daily - INFO - 准备执行股票日线数据任务...
2025-04-08 11:52:51,437 - task.stock_daily - INFO - 获取数据，日期范围: 20250309 至 20250408
2025-04-08 11:52:51,437 - task.stock_daily - INFO - 正在从Tushare获取数据，API: daily，参数: {'start_date': '20250309', 'end_date': '20250408', 'ts_code': '000001.SZ,000002.SZ,000063.SZ,000066.SZ,000333.SZ,000651.SZ,000858.SZ'}
2025-04-08 11:52:51,720 - task.stock_daily - INFO - 从Tushare获取到140条数据
2025-04-08 11:52:51,720 - task.stock_daily - INFO - 处理数据，共 140 行
2025-04-08 11:52:51,724 - task.stock_daily - INFO - 验证数据
2025-04-08 11:52:51,724 - task.stock_daily - INFO - 保存数据到表 stock_daily
2025-04-08 11:52:51,733 - db_manager - ERROR - 批量SQL执行失败: 语法错误 在 "%" 或附近的
SQL: 
                INSERT INTO stock_daily (ts_code, trade_date, open, high, low, close, pre_close, change, pct_chg, vol, amount)
                VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
                ON CONFLICT (ts_code, trade_date) 
                DO UPDATE SET open = EXCLUDED.open, high = EXCLUDED.high, low = EXCLUDED.low, close = EXCLUDED.close, pre_close = EXCLUDED.pre_close, change = EXCLUDED.change, pct_chg = EXCLUDED.pct_chg, vol = EXCLUDED.vol, amount = EXCLUDED.amount;
                
2025-04-08 11:52:51,733 - task.stock_daily - ERROR - 任务执行失败: 语法错误 在 "%" 或附近的
Traceback (most recent call last):
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 58, in execute
    result = await self.save_data(data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 202, in save_data
    affected_rows = await self._save_to_database(data)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 337, in _save_to_database
    affected_rows = await self.db.executemany(upsert_sql, values)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\db_manager.py", line 141, in executemany
    stmt = await conn.prepare(query)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.PostgresSyntaxError: 语法错误 在 "%" 或附近的
2025-04-08 11:52:51,736 - stock_data_example - INFO - 股票日线数据任务执行结果: {'status': 'error', 'error': '语法错误 在 "%" 或附近的', 'task': 'stock_daily'}
2025-04-08 11:52:51,736 - stock_data_example - INFO - 执行股票基本面数据任务...
2025-04-08 11:52:51,736 - task.stock_daily_basic - INFO - 开始执行任务: stock_daily_basic
2025-04-08 11:52:51,736 - task.stock_daily_basic - INFO - 准备执行股票每日基本面指标任务...
2025-04-08 11:52:51,737 - task.stock_daily_basic - ERROR - 任务执行失败: 'StockDailyBasicTask' object has no attribute 'db_manager'
Traceback (most recent call last):
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 34, in execute
    await self.pre_execute()
  File "e:\CodePrograms\autoDatabase\data_module\tasks\stock\daily_basic.py", line 162, in pre_execute
    if self.db_manager and "stock_daily" in self.dependencies:
       ^^^^^^^^^^^^^^^
AttributeError: 'StockDailyBasicTask' object has no attribute 'db_manager'
2025-04-08 11:52:51,738 - stock_data_example - INFO - 股票基本面数据任务执行结果: {'status': 'error', 'error': "'StockDailyBasicTask' object has no attribute 'db_manager'", 'task': 'stock_daily_basic'}
2025-04-08 11:52:51,738 - stock_data_example - INFO - 执行指数日线数据任务...
2025-04-08 11:52:51,738 - task.index_daily - INFO - 开始执行任务: index_daily
2025-04-08 11:52:51,738 - task.index_daily - INFO - 准备执行指数日线数据任务...
2025-04-08 11:52:51,739 - task.index_daily - INFO - 获取数据，日期范围: 20250309 至 20250408
2025-04-08 11:52:51,739 - task.index_daily - INFO - 正在从Tushare获取数据，API: index_daily，参数: {'start_date': '20250309', 'end_date': '20250408', 'ts_code': '000001.SH,399001.SZ,399006.SZ'}
2025-04-08 11:52:52,042 - task.index_daily - INFO - 从Tushare获取到0条数据
2025-04-08 11:52:52,043 - task.index_daily - INFO - 没有获取到数据
2025-04-08 11:52:52,043 - stock_data_example - INFO - 指数日线数据任务执行结果: {'status': 'no_data', 'rows': 0}
2025-04-08 11:52:52,043 - stock_data_example - INFO - 执行股票日线数据增量更新...
2025-04-08 11:52:52,044 - task.stock_daily - INFO - 开始执行stock_daily的增量更新，日期范围: 20250401 至 20250408...
2025-04-08 11:52:52,044 - task.stock_daily - INFO - 开始执行任务: stock_daily
2025-04-08 11:52:52,045 - task.stock_daily - INFO - 准备执行股票日线数据任务...
2025-04-08 11:52:52,045 - task.stock_daily - INFO - 获取数据，日期范围: 20250401 至 20250408
2025-04-08 11:52:52,045 - task.stock_daily - INFO - 正在从Tushare获取数据，API: daily，参数: {'start_date': '20250401', 'end_date': '20250408', 'ts_code': '000001.SZ,000002.SZ,000063.SZ,000066.SZ,000333.SZ,000651.SZ,000858.SZ'}
2025-04-08 11:52:52,371 - task.stock_daily - INFO - 从Tushare获取到28条数据
2025-04-08 11:52:52,371 - task.stock_daily - INFO - 处理数据，共 28 行
2025-04-08 11:52:52,373 - task.stock_daily - INFO - 验证数据
2025-04-08 11:52:52,373 - task.stock_daily - INFO - 保存数据到表 stock_daily
2025-04-08 11:52:52,375 - db_manager - ERROR - 批量SQL执行失败: 语法错误 在 "%" 或附近的
SQL: 
                INSERT INTO stock_daily (ts_code, trade_date, open, high, low, close, pre_close, change, pct_chg, vol, amount)
                VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
                ON CONFLICT (ts_code, trade_date) 
                DO UPDATE SET open = EXCLUDED.open, high = EXCLUDED.high, low = EXCLUDED.low, close = EXCLUDED.close, pre_close = EXCLUDED.pre_close, change = EXCLUDED.change, pct_chg = EXCLUDED.pct_chg, vol = EXCLUDED.vol, amount = EXCLUDED.amount;
                
2025-04-08 11:52:52,376 - task.stock_daily - ERROR - 任务执行失败: 语法错误 在 "%" 或附近的
Traceback (most recent call last):
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 58, in execute
    result = await self.save_data(data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 202, in save_data
    affected_rows = await self._save_to_database(data)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 337, in _save_to_database
    affected_rows = await self.db.executemany(upsert_sql, values)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\db_manager.py", line 141, in executemany
    stmt = await conn.prepare(query)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.PostgresSyntaxError: 语法错误 在 "%" 或附近的
2025-04-08 11:52:52,377 - task.stock_daily - INFO - 增量更新完成: {'status': 'error', 'error': '语法错误 在 "%" 或附近的', 'task': 'stock_daily'}
2025-04-08 11:52:52,377 - stock_data_example - INFO - 股票日线数据增量更新结果: {'status': 'error', 'error': '语法错误 在 "%" 或附近的', 'task': 'stock_daily'}
2025-04-08 11:52:52,391 - db_manager - INFO - 数据库连接池已关闭
2025-04-08 11:55:07,823 - db_manager - INFO - 数据库连接池创建成功
2025-04-08 11:55:08,349 - task.stock_daily - INFO - Tushare API初始化成功
2025-04-08 11:55:08,351 - task.stock_daily_basic - INFO - Tushare API初始化成功
2025-04-08 11:55:08,351 - task.index_daily - INFO - Tushare API初始化成功
2025-04-08 11:55:08,351 - stock_data_example - INFO - 开始获取从 20250309 到 20250408 的数据
2025-04-08 11:55:08,352 - stock_data_example - INFO - 执行股票日线数据任务...
2025-04-08 11:55:08,352 - task.stock_daily - INFO - 开始执行任务: stock_daily
2025-04-08 11:55:08,352 - task.stock_daily - INFO - 准备执行股票日线数据任务...
2025-04-08 11:55:08,352 - task.stock_daily - INFO - 获取数据，日期范围: 20250309 至 20250408
2025-04-08 11:55:08,352 - task.stock_daily - INFO - 正在从Tushare获取数据，API: daily，参数: {'start_date': '20250309', 'end_date': '20250408', 'ts_code': '000001.SZ,000002.SZ,000063.SZ,000066.SZ,000333.SZ,000651.SZ,000858.SZ'}
2025-04-08 11:55:08,609 - task.stock_daily - INFO - 从Tushare获取到140条数据
2025-04-08 11:55:08,610 - task.stock_daily - INFO - 处理数据，共 140 行
2025-04-08 11:55:08,613 - task.stock_daily - INFO - 验证数据
2025-04-08 11:55:08,614 - task.stock_daily - INFO - 保存数据到表 stock_daily
2025-04-08 11:55:08,621 - db_manager - ERROR - 批量SQL执行失败: 'PreparedStatement' object has no attribute 'execute'
SQL: 
                INSERT INTO stock_daily (ts_code, trade_date, open, high, low, close, pre_close, change, pct_chg, vol, amount)
                VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11)
                ON CONFLICT (ts_code, trade_date) 
                DO UPDATE SET open = EXCLUDED.open, high = EXCLUDED.high, low = EXCLUDED.low, close = EXCLUDED.close, pre_close = EXCLUDED.pre_close, change = EXCLUDED.change, pct_chg = EXCLUDED.pct_chg, vol = EXCLUDED.vol, amount = EXCLUDED.amount;
                
2025-04-08 11:55:08,622 - task.stock_daily - ERROR - 任务执行失败: 'PreparedStatement' object has no attribute 'execute'
Traceback (most recent call last):
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 58, in execute
    result = await self.save_data(data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 202, in save_data
    affected_rows = await self._save_to_database(data)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 338, in _save_to_database
    affected_rows = await self.db.executemany(upsert_sql, values)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\db_manager.py", line 146, in executemany
    await stmt.execute(*args)
          ^^^^^^^^^^^^
AttributeError: 'PreparedStatement' object has no attribute 'execute'
2025-04-08 11:55:08,623 - stock_data_example - INFO - 股票日线数据任务执行结果: {'status': 'error', 'error': "'PreparedStatement' object has no attribute 'execute'", 'task': 'stock_daily'}
2025-04-08 11:55:08,624 - stock_data_example - INFO - 执行股票基本面数据任务...
2025-04-08 11:55:08,624 - task.stock_daily_basic - INFO - 开始执行任务: stock_daily_basic
2025-04-08 11:55:08,624 - task.stock_daily_basic - INFO - 准备执行股票每日基本面指标任务...
2025-04-08 11:55:08,626 - task.stock_daily_basic - WARNING - 未找到股票日线数据，依赖任务可能未完成
2025-04-08 11:55:08,626 - task.stock_daily_basic - INFO - 检查依赖任务: ['stock_daily']
2025-04-08 11:55:08,627 - task.stock_daily_basic - INFO - 获取数据，日期范围: 20250309 至 20250408
2025-04-08 11:55:08,627 - task.stock_daily_basic - INFO - 正在从Tushare获取数据，API: daily_basic，参数: {'start_date': '20250309', 'end_date': '20250408', 'ts_code': '000001.SZ,000002.SZ,000063.SZ,000066.SZ,000333.SZ,000651.SZ,000858.SZ'}
2025-04-08 11:55:08,901 - task.stock_daily_basic - INFO - 从Tushare获取到140条数据
2025-04-08 11:55:08,901 - task.stock_daily_basic - INFO - 处理数据，共 140 行
2025-04-08 11:55:08,911 - task.stock_daily_basic - INFO - 验证数据
2025-04-08 11:55:08,914 - task.stock_daily_basic - INFO - 保存数据到表 stock_daily_basic
2025-04-08 11:55:08,916 - task.stock_daily_basic - INFO - 表 stock_daily_basic 不存在，正在创建...
2025-04-08 11:55:08,920 - task.stock_daily_basic - INFO - 表 stock_daily_basic 创建成功
2025-04-08 11:55:08,922 - task.stock_daily_basic - INFO - 为表 stock_daily_basic 的 ts_code 列创建索引
2025-04-08 11:55:08,923 - task.stock_daily_basic - INFO - 为表 stock_daily_basic 的 trade_date 列创建索引
2025-04-08 11:55:08,930 - db_manager - ERROR - 批量SQL执行失败: 关系 "stock_daily_basic" 的 "free_mv" 字段不存在
SQL: 
                INSERT INTO stock_daily_basic (ts_code, trade_date, close, turnover_rate, turnover_rate_f, volume_ratio, pe, pe_ttm, pb, ps, ps_ttm, dv_ratio, dv_ttm, total_share, float_share, free_share, total_mv, circ_mv, free_mv, float_ratio, bp_ratio, annual_div_yield)
                VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22)
                ON CONFLICT (ts_code, trade_date) 
                DO UPDATE SET close = EXCLUDED.close, turnover_rate = EXCLUDED.turnover_rate, turnover_rate_f = EXCLUDED.turnover_rate_f, volume_ratio = EXCLUDED.volume_ratio, pe = EXCLUDED.pe, pe_ttm = EXCLUDED.pe_ttm, pb = EXCLUDED.pb, ps = EXCLUDED.ps, ps_ttm = EXCLUDED.ps_ttm, dv_ratio = EXCLUDED.dv_ratio, dv_ttm = EXCLUDED.dv_ttm, total_share = EXCLUDED.total_share, float_share = EXCLUDED.float_share, free_share = EXCLUDED.free_share, total_mv = EXCLUDED.total_mv, circ_mv = EXCLUDED.circ_mv, free_mv = EXCLUDED.free_mv, float_ratio = EXCLUDED.float_ratio, bp_ratio = EXCLUDED.bp_ratio, annual_div_yield = EXCLUDED.annual_div_yield;
                
2025-04-08 11:55:08,930 - task.stock_daily_basic - ERROR - 任务执行失败: 关系 "stock_daily_basic" 的 "free_mv" 字段不存在
Traceback (most recent call last):
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 58, in execute
    result = await self.save_data(data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 202, in save_data
    affected_rows = await self._save_to_database(data)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 338, in _save_to_database
    affected_rows = await self.db.executemany(upsert_sql, values)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\db_manager.py", line 141, in executemany
    stmt = await conn.prepare(query)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: 关系 "stock_daily_basic" 的 "free_mv" 字段不存在
2025-04-08 11:55:08,931 - stock_data_example - INFO - 股票基本面数据任务执行结果: {'status': 'error', 'error': '关系 "stock_daily_basic" 的 "free_mv" 字段不存在', 'task': 'stock_daily_basic'}
2025-04-08 11:55:08,931 - stock_data_example - INFO - 执行指数日线数据任务...
2025-04-08 11:55:08,932 - task.index_daily - INFO - 开始执行任务: index_daily
2025-04-08 11:55:08,932 - task.index_daily - INFO - 准备执行指数日线数据任务...
2025-04-08 11:55:08,932 - task.index_daily - INFO - 获取数据，日期范围: 20250309 至 20250408
2025-04-08 11:55:08,933 - task.index_daily - INFO - 正在从Tushare获取数据，API: index_daily，参数: {'start_date': '20250309', 'end_date': '20250408', 'ts_code': '000001.SH,399001.SZ,399006.SZ'}
2025-04-08 11:55:09,211 - task.index_daily - INFO - 从Tushare获取到0条数据
2025-04-08 11:55:09,212 - task.index_daily - INFO - 没有获取到数据
2025-04-08 11:55:09,212 - stock_data_example - INFO - 指数日线数据任务执行结果: {'status': 'no_data', 'rows': 0}
2025-04-08 11:55:09,213 - stock_data_example - INFO - 执行股票日线数据增量更新...
2025-04-08 11:55:09,213 - task.stock_daily - INFO - 开始执行stock_daily的增量更新，日期范围: 20250401 至 20250408...
2025-04-08 11:55:09,213 - task.stock_daily - INFO - 开始执行任务: stock_daily
2025-04-08 11:55:09,213 - task.stock_daily - INFO - 准备执行股票日线数据任务...
2025-04-08 11:55:09,213 - task.stock_daily - INFO - 获取数据，日期范围: 20250401 至 20250408
2025-04-08 11:55:09,213 - task.stock_daily - INFO - 正在从Tushare获取数据，API: daily，参数: {'start_date': '20250401', 'end_date': '20250408', 'ts_code': '000001.SZ,000002.SZ,000063.SZ,000066.SZ,000333.SZ,000651.SZ,000858.SZ'}
2025-04-08 11:55:09,512 - task.stock_daily - INFO - 从Tushare获取到28条数据
2025-04-08 11:55:09,512 - task.stock_daily - INFO - 处理数据，共 28 行
2025-04-08 11:55:09,513 - task.stock_daily - INFO - 验证数据
2025-04-08 11:55:09,515 - task.stock_daily - INFO - 保存数据到表 stock_daily
2025-04-08 11:55:09,516 - db_manager - ERROR - 批量SQL执行失败: 'PreparedStatement' object has no attribute 'execute'
SQL: 
                INSERT INTO stock_daily (ts_code, trade_date, open, high, low, close, pre_close, change, pct_chg, vol, amount)
                VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11)
                ON CONFLICT (ts_code, trade_date) 
                DO UPDATE SET open = EXCLUDED.open, high = EXCLUDED.high, low = EXCLUDED.low, close = EXCLUDED.close, pre_close = EXCLUDED.pre_close, change = EXCLUDED.change, pct_chg = EXCLUDED.pct_chg, vol = EXCLUDED.vol, amount = EXCLUDED.amount;
                
2025-04-08 11:55:09,517 - task.stock_daily - ERROR - 任务执行失败: 'PreparedStatement' object has no attribute 'execute'
Traceback (most recent call last):
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 58, in execute
    result = await self.save_data(data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 202, in save_data
    affected_rows = await self._save_to_database(data)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 338, in _save_to_database
    affected_rows = await self.db.executemany(upsert_sql, values)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\db_manager.py", line 146, in executemany
    await stmt.execute(*args)
          ^^^^^^^^^^^^
AttributeError: 'PreparedStatement' object has no attribute 'execute'
2025-04-08 11:55:09,518 - task.stock_daily - INFO - 增量更新完成: {'status': 'error', 'error': "'PreparedStatement' object has no attribute 'execute'", 'task': 'stock_daily'}
2025-04-08 11:55:09,518 - stock_data_example - INFO - 股票日线数据增量更新结果: {'status': 'error', 'error': "'PreparedStatement' object has no attribute 'execute'", 'task': 'stock_daily'}
2025-04-08 11:55:09,532 - db_manager - INFO - 数据库连接池已关闭
2025-04-08 11:56:45,378 - db_manager - INFO - 数据库连接池创建成功
2025-04-08 11:56:45,916 - task.stock_daily - INFO - Tushare API初始化成功
2025-04-08 11:56:45,916 - task.stock_daily_basic - INFO - Tushare API初始化成功
2025-04-08 11:56:45,917 - task.index_daily - INFO - Tushare API初始化成功
2025-04-08 11:56:45,917 - stock_data_example - INFO - 开始获取从 20250309 到 20250408 的数据
2025-04-08 11:56:45,917 - stock_data_example - INFO - 执行股票日线数据任务...
2025-04-08 11:56:45,917 - task.stock_daily - INFO - 开始执行任务: stock_daily
2025-04-08 11:56:45,917 - task.stock_daily - INFO - 准备执行股票日线数据任务...
2025-04-08 11:56:45,917 - task.stock_daily - INFO - 获取数据，日期范围: 20250309 至 20250408
2025-04-08 11:56:45,917 - task.stock_daily - INFO - 正在从Tushare获取数据，API: daily，参数: {'start_date': '20250309', 'end_date': '20250408', 'ts_code': '000001.SZ,000002.SZ,000063.SZ,000066.SZ,000333.SZ,000651.SZ,000858.SZ'}
2025-04-08 11:56:46,218 - task.stock_daily - INFO - 从Tushare获取到140条数据
2025-04-08 11:56:46,218 - task.stock_daily - INFO - 处理数据，共 140 行
2025-04-08 11:56:46,222 - task.stock_daily - INFO - 验证数据
2025-04-08 11:56:46,222 - task.stock_daily - INFO - 保存数据到表 stock_daily
2025-04-08 11:56:46,259 - task.stock_daily - INFO - 股票日线数据任务执行完成，结果: {'status': 'success', 'table': 'stock_daily', 'rows': 140}
2025-04-08 11:56:46,259 - task.stock_daily - INFO - 任务执行完成: {'status': 'success', 'table': 'stock_daily', 'rows': 140}
2025-04-08 11:56:46,259 - stock_data_example - INFO - 股票日线数据任务执行结果: {'status': 'success', 'table': 'stock_daily', 'rows': 140}
2025-04-08 11:56:46,259 - stock_data_example - INFO - 执行股票基本面数据任务...
2025-04-08 11:56:46,259 - task.stock_daily_basic - INFO - 开始执行任务: stock_daily_basic
2025-04-08 11:56:46,259 - task.stock_daily_basic - INFO - 准备执行股票每日基本面指标任务...
2025-04-08 11:56:46,260 - task.stock_daily_basic - INFO - 股票日线数据最新日期: 2025-04-07
2025-04-08 11:56:46,260 - task.stock_daily_basic - INFO - 检查依赖任务: ['stock_daily']
2025-04-08 11:56:46,260 - task.stock_daily_basic - INFO - 获取数据，日期范围: 20250309 至 20250408
2025-04-08 11:56:46,260 - task.stock_daily_basic - INFO - 正在从Tushare获取数据，API: daily_basic，参数: {'start_date': '20250309', 'end_date': '20250408', 'ts_code': '000001.SZ,000002.SZ,000063.SZ,000066.SZ,000333.SZ,000651.SZ,000858.SZ'}
2025-04-08 11:56:46,579 - task.stock_daily_basic - INFO - 从Tushare获取到140条数据
2025-04-08 11:56:46,579 - task.stock_daily_basic - INFO - 处理数据，共 140 行
2025-04-08 11:56:46,588 - task.stock_daily_basic - INFO - 验证数据
2025-04-08 11:56:46,589 - task.stock_daily_basic - INFO - 保存数据到表 stock_daily_basic
2025-04-08 11:56:46,595 - db_manager - ERROR - 批量SQL执行失败: 关系 "stock_daily_basic" 的 "free_mv" 字段不存在
SQL: 
                INSERT INTO stock_daily_basic (ts_code, trade_date, close, turnover_rate, turnover_rate_f, volume_ratio, pe, pe_ttm, pb, ps, ps_ttm, dv_ratio, dv_ttm, total_share, float_share, free_share, total_mv, circ_mv, free_mv, float_ratio, bp_ratio, annual_div_yield)
                VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22)
                ON CONFLICT (ts_code, trade_date) 
                DO UPDATE SET close = EXCLUDED.close, turnover_rate = EXCLUDED.turnover_rate, turnover_rate_f = EXCLUDED.turnover_rate_f, volume_ratio = EXCLUDED.volume_ratio, pe = EXCLUDED.pe, pe_ttm = EXCLUDED.pe_ttm, pb = EXCLUDED.pb, ps = EXCLUDED.ps, ps_ttm = EXCLUDED.ps_ttm, dv_ratio = EXCLUDED.dv_ratio, dv_ttm = EXCLUDED.dv_ttm, total_share = EXCLUDED.total_share, float_share = EXCLUDED.float_share, free_share = EXCLUDED.free_share, total_mv = EXCLUDED.total_mv, circ_mv = EXCLUDED.circ_mv, free_mv = EXCLUDED.free_mv, float_ratio = EXCLUDED.float_ratio, bp_ratio = EXCLUDED.bp_ratio, annual_div_yield = EXCLUDED.annual_div_yield;
                
2025-04-08 11:56:46,595 - task.stock_daily_basic - ERROR - 任务执行失败: 关系 "stock_daily_basic" 的 "free_mv" 字段不存在
Traceback (most recent call last):
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 58, in execute
    result = await self.save_data(data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 202, in save_data
    affected_rows = await self._save_to_database(data)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 338, in _save_to_database
    affected_rows = await self.db.executemany(upsert_sql, values)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\db_manager.py", line 141, in executemany
    stmt = await conn.prepare(query)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: 关系 "stock_daily_basic" 的 "free_mv" 字段不存在
2025-04-08 11:56:46,598 - stock_data_example - INFO - 股票基本面数据任务执行结果: {'status': 'error', 'error': '关系 "stock_daily_basic" 的 "free_mv" 字段不存在', 'task': 'stock_daily_basic'}
2025-04-08 11:56:46,598 - stock_data_example - INFO - 执行指数日线数据任务...
2025-04-08 11:56:46,599 - task.index_daily - INFO - 开始执行任务: index_daily
2025-04-08 11:56:46,599 - task.index_daily - INFO - 准备执行指数日线数据任务...
2025-04-08 11:56:46,599 - task.index_daily - INFO - 获取数据，日期范围: 20250309 至 20250408
2025-04-08 11:56:46,599 - task.index_daily - INFO - 正在从Tushare获取数据，API: index_daily，参数: {'start_date': '20250309', 'end_date': '20250408', 'ts_code': '000001.SH,399001.SZ,399006.SZ'}
2025-04-08 11:56:46,860 - task.index_daily - INFO - 从Tushare获取到0条数据
2025-04-08 11:56:46,860 - task.index_daily - INFO - 没有获取到数据
2025-04-08 11:56:46,860 - stock_data_example - INFO - 指数日线数据任务执行结果: {'status': 'no_data', 'rows': 0}
2025-04-08 11:56:46,860 - stock_data_example - INFO - 执行股票日线数据增量更新...
2025-04-08 11:56:46,862 - task.stock_daily - INFO - 开始执行stock_daily的增量更新，日期范围: 20250331 至 20250408...
2025-04-08 11:56:46,862 - task.stock_daily - INFO - 开始执行任务: stock_daily
2025-04-08 11:56:46,862 - task.stock_daily - INFO - 准备执行股票日线数据任务...
2025-04-08 11:56:46,862 - task.stock_daily - INFO - 获取数据，日期范围: 20250331 至 20250408
2025-04-08 11:56:46,862 - task.stock_daily - INFO - 正在从Tushare获取数据，API: daily，参数: {'start_date': '20250331', 'end_date': '20250408', 'ts_code': '000001.SZ,000002.SZ,000063.SZ,000066.SZ,000333.SZ,000651.SZ,000858.SZ'}
2025-04-08 11:56:47,183 - task.stock_daily - INFO - 从Tushare获取到35条数据
2025-04-08 11:56:47,183 - task.stock_daily - INFO - 处理数据，共 35 行
2025-04-08 11:56:47,185 - task.stock_daily - INFO - 验证数据
2025-04-08 11:56:47,186 - task.stock_daily - INFO - 保存数据到表 stock_daily
2025-04-08 11:56:47,195 - task.stock_daily - INFO - 股票日线数据任务执行完成，结果: {'status': 'success', 'table': 'stock_daily', 'rows': 35}
2025-04-08 11:56:47,195 - task.stock_daily - INFO - 任务执行完成: {'status': 'success', 'table': 'stock_daily', 'rows': 35}
2025-04-08 11:56:47,195 - task.stock_daily - INFO - 增量更新完成: {'status': 'success', 'table': 'stock_daily', 'rows': 35}
2025-04-08 11:56:47,195 - stock_data_example - INFO - 股票日线数据增量更新结果: {'status': 'success', 'table': 'stock_daily', 'rows': 35}
2025-04-08 11:56:47,207 - db_manager - INFO - 数据库连接池已关闭
2025-04-08 11:58:15,986 - db_manager - INFO - 数据库连接池创建成功
2025-04-08 11:58:16,515 - task.stock_daily - INFO - Tushare API初始化成功
2025-04-08 11:58:16,515 - task.stock_daily_basic - INFO - Tushare API初始化成功
2025-04-08 11:58:16,515 - task.index_daily - INFO - Tushare API初始化成功
2025-04-08 11:58:16,515 - stock_data_example - INFO - 开始获取从 20250309 到 20250408 的数据
2025-04-08 11:58:16,515 - stock_data_example - INFO - 执行股票日线数据任务...
2025-04-08 11:58:16,516 - task.stock_daily - INFO - 开始执行任务: stock_daily
2025-04-08 11:58:16,516 - task.stock_daily - INFO - 准备执行股票日线数据任务...
2025-04-08 11:58:16,516 - task.stock_daily - INFO - 获取数据，日期范围: 20250309 至 20250408
2025-04-08 11:58:16,516 - task.stock_daily - INFO - 正在从Tushare获取数据，API: daily，参数: {'start_date': '20250309', 'end_date': '20250408', 'ts_code': '000001.SZ,000002.SZ,000063.SZ,000066.SZ,000333.SZ,000651.SZ,000858.SZ'}
2025-04-08 11:58:16,802 - task.stock_daily - INFO - 从Tushare获取到140条数据
2025-04-08 11:58:16,802 - task.stock_daily - INFO - 处理数据，共 140 行
2025-04-08 11:58:16,806 - task.stock_daily - INFO - 验证数据
2025-04-08 11:58:16,807 - task.stock_daily - INFO - 保存数据到表 stock_daily
2025-04-08 11:58:16,840 - task.stock_daily - INFO - 股票日线数据任务执行完成，结果: {'status': 'success', 'table': 'stock_daily', 'rows': 140}
2025-04-08 11:58:16,840 - task.stock_daily - INFO - 任务执行完成: {'status': 'success', 'table': 'stock_daily', 'rows': 140}
2025-04-08 11:58:16,840 - stock_data_example - INFO - 股票日线数据任务执行结果: {'status': 'success', 'table': 'stock_daily', 'rows': 140}
2025-04-08 11:58:16,840 - stock_data_example - INFO - 执行股票基本面数据任务...
2025-04-08 11:58:16,840 - task.stock_daily_basic - INFO - 开始执行任务: stock_daily_basic
2025-04-08 11:58:16,841 - task.stock_daily_basic - INFO - 准备执行股票每日基本面指标任务...
2025-04-08 11:58:16,842 - task.stock_daily_basic - INFO - 股票日线数据最新日期: 2025-04-07
2025-04-08 11:58:16,843 - task.stock_daily_basic - INFO - 检查依赖任务: ['stock_daily']
2025-04-08 11:58:16,843 - task.stock_daily_basic - INFO - 获取数据，日期范围: 20250309 至 20250408
2025-04-08 11:58:16,843 - task.stock_daily_basic - INFO - 正在从Tushare获取数据，API: daily_basic，参数: {'start_date': '20250309', 'end_date': '20250408', 'ts_code': '000001.SZ,000002.SZ,000063.SZ,000066.SZ,000333.SZ,000651.SZ,000858.SZ'}
2025-04-08 11:58:17,125 - task.stock_daily_basic - INFO - 从Tushare获取到140条数据
2025-04-08 11:58:17,125 - task.stock_daily_basic - INFO - 处理数据，共 140 行
2025-04-08 11:58:17,134 - task.stock_daily_basic - INFO - 验证数据
2025-04-08 11:58:17,136 - task.stock_daily_basic - INFO - 保存数据到表 stock_daily_basic
2025-04-08 11:58:17,138 - task.stock_daily_basic - INFO - 表 stock_daily_basic 不存在，正在创建...
2025-04-08 11:58:17,143 - task.stock_daily_basic - INFO - 表 stock_daily_basic 创建成功
2025-04-08 11:58:17,145 - task.stock_daily_basic - INFO - 为表 stock_daily_basic 的 ts_code 列创建索引
2025-04-08 11:58:17,146 - task.stock_daily_basic - INFO - 为表 stock_daily_basic 的 trade_date 列创建索引
2025-04-08 11:58:17,182 - task.stock_daily_basic - INFO - 股票每日基本面指标任务执行完成，结果: {'status': 'success', 'table': 'stock_daily_basic', 'rows': 140}
2025-04-08 11:58:17,186 - task.stock_daily_basic - INFO - 数据质量检查完成
2025-04-08 11:58:17,186 - task.stock_daily_basic - INFO - 任务执行完成: {'status': 'success', 'table': 'stock_daily_basic', 'rows': 140}
2025-04-08 11:58:17,187 - stock_data_example - INFO - 股票基本面数据任务执行结果: {'status': 'success', 'table': 'stock_daily_basic', 'rows': 140}
2025-04-08 11:58:17,187 - stock_data_example - INFO - 执行指数日线数据任务...
2025-04-08 11:58:17,187 - task.index_daily - INFO - 开始执行任务: index_daily
2025-04-08 11:58:17,187 - task.index_daily - INFO - 准备执行指数日线数据任务...
2025-04-08 11:58:17,187 - task.index_daily - INFO - 获取数据，日期范围: 20250309 至 20250408
2025-04-08 11:58:17,188 - task.index_daily - INFO - 正在从Tushare获取数据，API: index_daily，参数: {'start_date': '20250309', 'end_date': '20250408', 'ts_code': '000001.SH,399001.SZ,399006.SZ'}
2025-04-08 11:58:17,451 - task.index_daily - INFO - 从Tushare获取到0条数据
2025-04-08 11:58:17,451 - task.index_daily - INFO - 没有获取到数据
2025-04-08 11:58:17,451 - stock_data_example - INFO - 指数日线数据任务执行结果: {'status': 'no_data', 'rows': 0}
2025-04-08 11:58:17,451 - stock_data_example - INFO - 执行股票日线数据增量更新...
2025-04-08 11:58:17,452 - task.stock_daily - INFO - 开始执行stock_daily的增量更新，日期范围: 20250331 至 20250408...
2025-04-08 11:58:17,453 - task.stock_daily - INFO - 开始执行任务: stock_daily
2025-04-08 11:58:17,453 - task.stock_daily - INFO - 准备执行股票日线数据任务...
2025-04-08 11:58:17,453 - task.stock_daily - INFO - 获取数据，日期范围: 20250331 至 20250408
2025-04-08 11:58:17,453 - task.stock_daily - INFO - 正在从Tushare获取数据，API: daily，参数: {'start_date': '20250331', 'end_date': '20250408', 'ts_code': '000001.SZ,000002.SZ,000063.SZ,000066.SZ,000333.SZ,000651.SZ,000858.SZ'}
2025-04-08 11:58:17,759 - task.stock_daily - INFO - 从Tushare获取到35条数据
2025-04-08 11:58:17,759 - task.stock_daily - INFO - 处理数据，共 35 行
2025-04-08 11:58:17,762 - task.stock_daily - INFO - 验证数据
2025-04-08 11:58:17,762 - task.stock_daily - INFO - 保存数据到表 stock_daily
2025-04-08 11:58:17,772 - task.stock_daily - INFO - 股票日线数据任务执行完成，结果: {'status': 'success', 'table': 'stock_daily', 'rows': 35}
2025-04-08 11:58:17,772 - task.stock_daily - INFO - 任务执行完成: {'status': 'success', 'table': 'stock_daily', 'rows': 35}
2025-04-08 11:58:17,772 - task.stock_daily - INFO - 增量更新完成: {'status': 'success', 'table': 'stock_daily', 'rows': 35}
2025-04-08 11:58:17,772 - stock_data_example - INFO - 股票日线数据增量更新结果: {'status': 'success', 'table': 'stock_daily', 'rows': 35}
2025-04-08 11:58:17,785 - db_manager - INFO - 数据库连接池已关闭
2025-04-08 11:58:25,823 - db_manager - INFO - 数据库连接池创建成功
2025-04-08 11:58:26,374 - task.stock_daily - INFO - Tushare API初始化成功
2025-04-08 11:58:26,375 - task.stock_daily_basic - INFO - Tushare API初始化成功
2025-04-08 11:58:26,375 - task.index_daily - INFO - Tushare API初始化成功
2025-04-08 11:58:26,375 - stock_data_example - INFO - 开始获取从 20250309 到 20250408 的数据
2025-04-08 11:58:26,375 - stock_data_example - INFO - 执行股票日线数据任务...
2025-04-08 11:58:26,375 - task.stock_daily - INFO - 开始执行任务: stock_daily
2025-04-08 11:58:26,376 - task.stock_daily - INFO - 准备执行股票日线数据任务...
2025-04-08 11:58:26,376 - task.stock_daily - INFO - 获取数据，日期范围: 20250309 至 20250408
2025-04-08 11:58:26,376 - task.stock_daily - INFO - 正在从Tushare获取数据，API: daily，参数: {'start_date': '20250309', 'end_date': '20250408', 'ts_code': '000001.SZ,000002.SZ,000063.SZ,000066.SZ,000333.SZ,000651.SZ,000858.SZ'}
2025-04-08 11:58:26,667 - task.stock_daily - INFO - 从Tushare获取到140条数据
2025-04-08 11:58:26,667 - task.stock_daily - INFO - 处理数据，共 140 行
2025-04-08 11:58:26,671 - task.stock_daily - INFO - 验证数据
2025-04-08 11:58:26,672 - task.stock_daily - INFO - 保存数据到表 stock_daily
2025-04-08 11:58:26,705 - task.stock_daily - INFO - 股票日线数据任务执行完成，结果: {'status': 'success', 'table': 'stock_daily', 'rows': 140}
2025-04-08 11:58:26,705 - task.stock_daily - INFO - 任务执行完成: {'status': 'success', 'table': 'stock_daily', 'rows': 140}
2025-04-08 11:58:26,707 - stock_data_example - INFO - 股票日线数据任务执行结果: {'status': 'success', 'table': 'stock_daily', 'rows': 140}
2025-04-08 11:58:26,707 - stock_data_example - INFO - 执行股票基本面数据任务...
2025-04-08 11:58:26,707 - task.stock_daily_basic - INFO - 开始执行任务: stock_daily_basic
2025-04-08 11:58:26,707 - task.stock_daily_basic - INFO - 准备执行股票每日基本面指标任务...
2025-04-08 11:58:26,707 - task.stock_daily_basic - INFO - 股票日线数据最新日期: 2025-04-07
2025-04-08 11:58:26,709 - task.stock_daily_basic - INFO - 检查依赖任务: ['stock_daily']
2025-04-08 11:58:26,709 - task.stock_daily_basic - INFO - 获取数据，日期范围: 20250309 至 20250408
2025-04-08 11:58:26,709 - task.stock_daily_basic - INFO - 正在从Tushare获取数据，API: daily_basic，参数: {'start_date': '20250309', 'end_date': '20250408', 'ts_code': '000001.SZ,000002.SZ,000063.SZ,000066.SZ,000333.SZ,000651.SZ,000858.SZ'}
2025-04-08 11:58:27,002 - task.stock_daily_basic - INFO - 从Tushare获取到140条数据
2025-04-08 11:58:27,003 - task.stock_daily_basic - INFO - 处理数据，共 140 行
2025-04-08 11:58:27,010 - task.stock_daily_basic - INFO - 验证数据
2025-04-08 11:58:27,013 - task.stock_daily_basic - INFO - 保存数据到表 stock_daily_basic
2025-04-08 11:58:27,049 - task.stock_daily_basic - INFO - 股票每日基本面指标任务执行完成，结果: {'status': 'success', 'table': 'stock_daily_basic', 'rows': 140}
2025-04-08 11:58:27,053 - task.stock_daily_basic - INFO - 数据质量检查完成
2025-04-08 11:58:27,053 - task.stock_daily_basic - INFO - 任务执行完成: {'status': 'success', 'table': 'stock_daily_basic', 'rows': 140}
2025-04-08 11:58:27,053 - stock_data_example - INFO - 股票基本面数据任务执行结果: {'status': 'success', 'table': 'stock_daily_basic', 'rows': 140}
2025-04-08 11:58:27,054 - stock_data_example - INFO - 执行指数日线数据任务...
2025-04-08 11:58:27,054 - task.index_daily - INFO - 开始执行任务: index_daily
2025-04-08 11:58:27,054 - task.index_daily - INFO - 准备执行指数日线数据任务...
2025-04-08 11:58:27,054 - task.index_daily - INFO - 获取数据，日期范围: 20250309 至 20250408
2025-04-08 11:58:27,054 - task.index_daily - INFO - 正在从Tushare获取数据，API: index_daily，参数: {'start_date': '20250309', 'end_date': '20250408', 'ts_code': '000001.SH,399001.SZ,399006.SZ'}
2025-04-08 11:58:27,342 - task.index_daily - INFO - 从Tushare获取到0条数据
2025-04-08 11:58:27,342 - task.index_daily - INFO - 没有获取到数据
2025-04-08 11:58:27,342 - stock_data_example - INFO - 指数日线数据任务执行结果: {'status': 'no_data', 'rows': 0}
2025-04-08 11:58:27,342 - stock_data_example - INFO - 执行股票日线数据增量更新...
2025-04-08 11:58:27,343 - task.stock_daily - INFO - 开始执行stock_daily的增量更新，日期范围: 20250331 至 20250408...
2025-04-08 11:58:27,343 - task.stock_daily - INFO - 开始执行任务: stock_daily
2025-04-08 11:58:27,344 - task.stock_daily - INFO - 准备执行股票日线数据任务...
2025-04-08 11:58:27,344 - task.stock_daily - INFO - 获取数据，日期范围: 20250331 至 20250408
2025-04-08 11:58:27,344 - task.stock_daily - INFO - 正在从Tushare获取数据，API: daily，参数: {'start_date': '20250331', 'end_date': '20250408', 'ts_code': '000001.SZ,000002.SZ,000063.SZ,000066.SZ,000333.SZ,000651.SZ,000858.SZ'}
2025-04-08 11:58:27,652 - task.stock_daily - INFO - 从Tushare获取到35条数据
2025-04-08 11:58:27,652 - task.stock_daily - INFO - 处理数据，共 35 行
2025-04-08 11:58:27,655 - task.stock_daily - INFO - 验证数据
2025-04-08 11:58:27,657 - task.stock_daily - INFO - 保存数据到表 stock_daily
2025-04-08 11:58:27,667 - task.stock_daily - INFO - 股票日线数据任务执行完成，结果: {'status': 'success', 'table': 'stock_daily', 'rows': 35}
2025-04-08 11:58:27,667 - task.stock_daily - INFO - 任务执行完成: {'status': 'success', 'table': 'stock_daily', 'rows': 35}
2025-04-08 11:58:27,667 - task.stock_daily - INFO - 增量更新完成: {'status': 'success', 'table': 'stock_daily', 'rows': 35}
2025-04-08 11:58:27,667 - stock_data_example - INFO - 股票日线数据增量更新结果: {'status': 'success', 'table': 'stock_daily', 'rows': 35}
2025-04-08 11:58:27,683 - db_manager - INFO - 数据库连接池已关闭
2025-04-08 13:32:26,099 - db_manager - INFO - 数据库连接池创建成功
2025-04-08 13:32:26,662 - task.stock_daily - INFO - Tushare API初始化成功
2025-04-08 13:32:26,662 - task.stock_daily_basic - INFO - Tushare API初始化成功
2025-04-08 13:32:26,662 - task.index_daily - INFO - Tushare API初始化成功
2025-04-08 13:32:26,662 - stock_data_example - INFO - 开始获取从 20250309 到 20250408 的数据
2025-04-08 13:32:26,662 - stock_data_example - INFO - 执行股票日线数据任务...
2025-04-08 13:32:26,662 - task.stock_daily - INFO - 开始执行任务: stock_daily
2025-04-08 13:32:26,662 - task.stock_daily - INFO - 准备执行股票日线数据任务...
2025-04-08 13:32:26,662 - task.stock_daily - INFO - 获取数据，日期范围: 20250309 至 20250408
2025-04-08 13:32:26,663 - task.stock_daily - INFO - 正在从Tushare获取数据，API: daily，参数: {'start_date': '20250309', 'end_date': '20250408'}
2025-04-08 13:32:27,454 - task.stock_daily - INFO - 从Tushare获取到6000条数据
2025-04-08 13:32:27,454 - task.stock_daily - INFO - 处理数据，共 6000 行
2025-04-08 13:32:27,463 - task.stock_daily - INFO - 验证数据
2025-04-08 13:32:27,464 - task.stock_daily - INFO - 保存数据到表 stock_daily
2025-04-08 13:32:27,470 - task.stock_daily - INFO - 表 stock_daily 不存在，正在创建...
2025-04-08 13:32:27,474 - task.stock_daily - INFO - 表 stock_daily 创建成功
2025-04-08 13:32:27,475 - task.stock_daily - INFO - 为表 stock_daily 的 ts_code 列创建索引
2025-04-08 13:32:27,476 - task.stock_daily - INFO - 为表 stock_daily 的 trade_date 列创建索引
2025-04-08 13:32:28,649 - task.stock_daily - INFO - 股票日线数据任务执行完成，结果: {'status': 'success', 'table': 'stock_daily', 'rows': 6000}
2025-04-08 13:32:28,649 - task.stock_daily - INFO - 任务执行完成: {'status': 'success', 'table': 'stock_daily', 'rows': 6000}
2025-04-08 13:32:28,649 - stock_data_example - INFO - 股票日线数据任务执行结果: {'status': 'success', 'table': 'stock_daily', 'rows': 6000}
2025-04-08 13:32:28,649 - stock_data_example - INFO - 执行股票基本面数据任务...
2025-04-08 13:32:28,651 - task.stock_daily_basic - INFO - 开始执行任务: stock_daily_basic
2025-04-08 13:32:28,651 - task.stock_daily_basic - INFO - 准备执行股票每日基本面指标任务...
2025-04-08 13:32:28,652 - task.stock_daily_basic - INFO - 股票日线数据最新日期: 2025-04-07
2025-04-08 13:32:28,653 - task.stock_daily_basic - INFO - 检查依赖任务: ['stock_daily']
2025-04-08 13:32:28,653 - task.stock_daily_basic - INFO - 获取数据，日期范围: 20250309 至 20250408
2025-04-08 13:32:28,653 - task.stock_daily_basic - INFO - 正在从Tushare获取数据，API: daily_basic，参数: {'start_date': '20250309', 'end_date': '20250408'}
2025-04-08 13:32:29,495 - task.stock_daily_basic - INFO - 从Tushare获取到6000条数据
2025-04-08 13:32:29,495 - task.stock_daily_basic - INFO - 处理数据，共 6000 行
2025-04-08 13:32:29,514 - task.stock_daily_basic - INFO - 验证数据
2025-04-08 13:32:29,519 - task.stock_daily_basic - INFO - 保存数据到表 stock_daily_basic
2025-04-08 13:32:29,521 - task.stock_daily_basic - INFO - 表 stock_daily_basic 不存在，正在创建...
2025-04-08 13:32:29,523 - task.stock_daily_basic - INFO - 表 stock_daily_basic 创建成功
2025-04-08 13:32:29,525 - task.stock_daily_basic - INFO - 为表 stock_daily_basic 的 ts_code 列创建索引
2025-04-08 13:32:29,526 - task.stock_daily_basic - INFO - 为表 stock_daily_basic 的 trade_date 列创建索引
2025-04-08 13:32:30,975 - task.stock_daily_basic - INFO - 股票每日基本面指标任务执行完成，结果: {'status': 'success', 'table': 'stock_daily_basic', 'rows': 6000}
2025-04-08 13:32:31,008 - task.stock_daily_basic - INFO - 数据质量检查完成
2025-04-08 13:32:31,008 - task.stock_daily_basic - INFO - 任务执行完成: {'status': 'success', 'table': 'stock_daily_basic', 'rows': 6000}
2025-04-08 13:32:31,009 - stock_data_example - INFO - 股票基本面数据任务执行结果: {'status': 'success', 'table': 'stock_daily_basic', 'rows': 6000}
2025-04-08 13:32:31,009 - stock_data_example - INFO - 执行指数日线数据任务...
2025-04-08 13:32:31,009 - task.index_daily - INFO - 开始执行任务: index_daily
2025-04-08 13:32:31,009 - task.index_daily - INFO - 准备执行指数日线数据任务...
2025-04-08 13:32:31,011 - task.index_daily - INFO - 获取数据，日期范围: 20250309 至 20250408
2025-04-08 13:32:31,011 - task.index_daily - INFO - 正在从Tushare获取数据，API: index_daily，参数: {'start_date': '20250309', 'end_date': '20250408'}
2025-04-08 13:32:31,331 - task.index_daily - ERROR - Tushare API调用失败: 必填参数 ts_code
2025-04-08 13:32:31,331 - task.index_daily - ERROR - 任务执行失败: Tushare API调用失败: 必填参数 ts_code
Traceback (most recent call last):
  File "e:\CodePrograms\autoDatabase\data_module\sources\tushare.py", line 65, in fetch_data
    data = api_method(**params)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\tushare\pro\client.py", line 45, in query
    raise Exception(result['msg'])
Exception: 必填参数 ts_code

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "e:\CodePrograms\autoDatabase\data_module\task.py", line 42, in execute
    data = await self.fetch_data(start_date, end_date, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\CodePrograms\autoDatabase\data_module\sources\tushare.py", line 81, in fetch_data
    raise ValueError(f"Tushare API调用失败: {str(e)}")
ValueError: Tushare API调用失败: 必填参数 ts_code
2025-04-08 13:32:31,333 - stock_data_example - INFO - 指数日线数据任务执行结果: {'status': 'error', 'error': 'Tushare API调用失败: 必填参数 ts_code', 'task': 'index_daily'}
2025-04-08 13:32:31,333 - stock_data_example - INFO - 执行股票日线数据增量更新...
2025-04-08 13:32:31,334 - task.stock_daily - INFO - 开始执行stock_daily的增量更新，日期范围: 20250331 至 20250408...
2025-04-08 13:32:31,334 - task.stock_daily - INFO - 开始执行任务: stock_daily
2025-04-08 13:32:31,334 - task.stock_daily - INFO - 准备执行股票日线数据任务...
2025-04-08 13:32:31,335 - task.stock_daily - INFO - 获取数据，日期范围: 20250331 至 20250408
2025-04-08 13:32:31,335 - task.stock_daily - INFO - 正在从Tushare获取数据，API: daily，参数: {'start_date': '20250331', 'end_date': '20250408', 'ts_code': '000001.SZ,000002.SZ,000063.SZ,000066.SZ,000333.SZ,000651.SZ,000858.SZ'}
2025-04-08 13:32:31,682 - task.stock_daily - INFO - 从Tushare获取到35条数据
2025-04-08 13:32:31,682 - task.stock_daily - INFO - 处理数据，共 35 行
2025-04-08 13:32:31,684 - task.stock_daily - INFO - 验证数据
2025-04-08 13:32:31,685 - task.stock_daily - INFO - 保存数据到表 stock_daily
2025-04-08 13:32:31,694 - task.stock_daily - INFO - 股票日线数据任务执行完成，结果: {'status': 'success', 'table': 'stock_daily', 'rows': 35}
2025-04-08 13:32:31,694 - task.stock_daily - INFO - 任务执行完成: {'status': 'success', 'table': 'stock_daily', 'rows': 35}
2025-04-08 13:32:31,694 - task.stock_daily - INFO - 增量更新完成: {'status': 'success', 'table': 'stock_daily', 'rows': 35}
2025-04-08 13:32:31,695 - stock_data_example - INFO - 股票日线数据增量更新结果: {'status': 'success', 'table': 'stock_daily', 'rows': 35}
2025-04-08 13:32:31,710 - db_manager - INFO - 数据库连接池已关闭
2025-04-08 14:29:44,804 - stock_data_example - INFO - 开始执行 stock_data_example (全量更新 stock_daily)...
2025-04-08 14:29:45,239 - db_manager - INFO - 数据库连接池创建成功
2025-04-08 14:29:45,808 - task.stock_daily - INFO - Tushare API初始化成功
2025-04-08 14:29:45,808 - stock_data_example - INFO - 开始执行 StockDailyTask 全量更新，股票代码: 000001.SZ,000002.SZ
2025-04-08 14:29:45,808 - task.stock_daily - INFO - 开始执行stock_daily的全量更新...
2025-04-08 14:29:45,809 - task.stock_daily - INFO - 开始执行任务: stock_daily
2025-04-08 14:29:45,809 - task.stock_daily - INFO - 准备执行股票日线数据任务...
2025-04-08 14:29:45,809 - task.stock_daily - INFO - 获取数据，日期范围: None 至 None
2025-04-08 14:29:45,809 - task.stock_daily - INFO - 正在从Tushare获取数据，API: daily，参数: {'ts_code': '000001.SZ,000002.SZ'}
2025-04-08 14:29:45,809 - task.stock_daily - INFO - 获取第1页数据，offset=0, limit=2000
2025-04-08 14:29:46,903 - task.stock_daily - INFO - 获取第2页数据，offset=2000, limit=2000
2025-04-08 14:29:48,000 - task.stock_daily - INFO - 获取第3页数据，offset=4000, limit=2000
2025-04-08 14:29:49,032 - task.stock_daily - INFO - 获取第4页数据，offset=6000, limit=2000
2025-04-08 14:29:50,379 - task.stock_daily - INFO - 获取第5页数据，offset=8000, limit=2000
2025-04-08 14:29:51,467 - task.stock_daily - INFO - 获取第6页数据，offset=10000, limit=2000
2025-04-08 14:29:52,532 - task.stock_daily - INFO - 获取第7页数据，offset=12000, limit=2000
2025-04-08 14:29:53,651 - task.stock_daily - INFO - 获取第8页数据，offset=14000, limit=2000
2025-04-08 14:29:54,736 - task.stock_daily - INFO - 获取第9页数据，offset=16000, limit=2000
2025-04-08 14:29:55,114 - task.stock_daily - INFO - 从Tushare获取到16163条数据
2025-04-08 14:29:55,114 - task.stock_daily - INFO - 处理数据，共 16163 行
2025-04-08 14:29:55,135 - task.stock_daily - INFO - 开始根据 ['trade_date', 'ts_code'] 对数据进行排序...
2025-04-08 14:29:55,143 - task.stock_daily - INFO - 数据排序完成。
2025-04-08 14:29:55,145 - task.stock_daily - INFO - 验证数据
2025-04-08 14:29:55,148 - task.stock_daily - INFO - 保存数据到表 stock_daily
2025-04-08 14:29:55,153 - task.stock_daily - INFO - 表 stock_daily 不存在，正在创建...
2025-04-08 14:29:55,158 - task.stock_daily - INFO - 表 stock_daily 创建成功
2025-04-08 14:29:55,160 - task.stock_daily - INFO - 为表 stock_daily 的 ts_code 列创建索引
2025-04-08 14:29:55,162 - task.stock_daily - INFO - 为表 stock_daily 的 trade_date 列创建索引
2025-04-08 14:29:58,400 - task.stock_daily - INFO - 股票日线数据任务执行完成，结果: {'status': 'success', 'table': 'stock_daily', 'rows': 16163}
2025-04-08 14:29:58,401 - task.stock_daily - INFO - 任务执行完成: {'status': 'success', 'table': 'stock_daily', 'rows': 16163}
2025-04-08 14:29:58,401 - task.stock_daily - INFO - 全量更新完成: {'status': 'success', 'table': 'stock_daily', 'rows': 16163}
2025-04-08 14:29:58,401 - stock_data_example - INFO - StockDailyTask 全量更新完成。
2025-04-08 14:30:45,668 - stock_data_example - INFO - 开始执行 stock_data_example (全量更新 stock_daily)...
2025-04-08 14:30:46,114 - db_manager - INFO - 数据库连接池创建成功
2025-04-08 14:30:46,685 - task.stock_daily - INFO - Tushare API初始化成功
2025-04-08 14:30:46,685 - stock_data_example - INFO - 开始执行 StockDailyTask 全量更新，股票代码: 000001.SZ,000002.SZ
2025-04-08 14:30:46,685 - task.stock_daily - INFO - 开始执行stock_daily的全量更新...
2025-04-08 14:30:46,685 - task.stock_daily - INFO - 开始执行任务: stock_daily
2025-04-08 14:30:46,685 - task.stock_daily - INFO - 准备执行股票日线数据任务...
2025-04-08 14:30:46,685 - task.stock_daily - INFO - 获取数据，日期范围: None 至 None
2025-04-08 14:30:46,686 - task.stock_daily - INFO - 正在从Tushare获取数据，API: daily，参数: {'ts_code': '000001.SZ,000002.SZ'}
2025-04-08 14:30:46,686 - task.stock_daily - INFO - 获取第1页数据，offset=0, limit=2000
2025-04-08 14:30:47,858 - task.stock_daily - INFO - 获取第2页数据，offset=2000, limit=2000
2025-04-08 14:30:48,910 - task.stock_daily - INFO - 获取第3页数据，offset=4000, limit=2000
2025-04-08 14:30:50,086 - task.stock_daily - INFO - 获取第4页数据，offset=6000, limit=2000
2025-04-08 14:30:51,370 - task.stock_daily - INFO - 获取第5页数据，offset=8000, limit=2000
2025-04-08 14:30:52,530 - task.stock_daily - INFO - 获取第6页数据，offset=10000, limit=2000
2025-04-08 14:30:53,712 - task.stock_daily - INFO - 获取第7页数据，offset=12000, limit=2000
2025-04-08 14:30:54,766 - task.stock_daily - INFO - 获取第8页数据，offset=14000, limit=2000
2025-04-08 14:30:55,821 - task.stock_daily - INFO - 获取第9页数据，offset=16000, limit=2000
2025-04-08 14:30:56,191 - task.stock_daily - INFO - 从Tushare获取到16163条数据
2025-04-08 14:30:56,191 - task.stock_daily - INFO - 处理数据，共 16163 行
2025-04-08 14:30:56,213 - task.stock_daily - INFO - 开始根据 ['trade_date', 'ts_code'] 对数据进行排序...
2025-04-08 14:30:56,217 - task.stock_daily - INFO - 数据排序完成。
2025-04-08 14:30:56,219 - task.stock_daily - INFO - 验证数据
2025-04-08 14:30:56,222 - task.stock_daily - INFO - 保存数据到表 stock_daily
2025-04-08 14:30:59,608 - task.stock_daily - INFO - 股票日线数据任务执行完成，结果: {'status': 'success', 'table': 'stock_daily', 'rows': 16163}
2025-04-08 14:30:59,608 - task.stock_daily - INFO - 任务执行完成: {'status': 'success', 'table': 'stock_daily', 'rows': 16163}
2025-04-08 14:30:59,609 - task.stock_daily - INFO - 全量更新完成: {'status': 'success', 'table': 'stock_daily', 'rows': 16163}
2025-04-08 14:30:59,609 - stock_data_example - INFO - StockDailyTask 全量更新完成。
2025-04-08 14:30:59,634 - db_manager - INFO - 数据库连接池已关闭
2025-04-08 14:30:59,634 - stock_data_example - INFO - 数据库连接已关闭。
2025-04-08 14:30:59,635 - stock_data_example - INFO - stock_data_example 执行完毕。
2025-04-08 15:09:56,951 - stock_data_example - INFO - 开始执行 stock_data_example (全量更新 stock_daily)...
2025-04-08 15:09:57,386 - db_manager - INFO - 数据库连接池创建成功
2025-04-08 15:09:57,926 - task.stock_daily - INFO - Tushare API初始化成功
2025-04-08 15:09:57,926 - stock_data_example - INFO - 开始执行 StockDailyTask 全量更新，股票代码: 000001.SZ,000002.SZ
2025-04-08 15:09:57,927 - task.stock_daily - INFO - 开始执行stock_daily的全量更新...
2025-04-08 15:09:57,927 - task.stock_daily - INFO - 开始执行任务: stock_daily
2025-04-08 15:09:57,927 - task.stock_daily - INFO - 准备执行股票日线数据任务...
2025-04-08 15:09:57,927 - task.stock_daily - INFO - 获取数据，日期范围: None 至 None
2025-04-08 15:09:57,927 - task.stock_daily - INFO - 正在从Tushare获取数据，API: daily，参数: {'limit': 6000, 'page_interval': 0.1}
2025-04-08 15:09:57,927 - task.stock_daily - INFO - 获取第1页数据，offset=0, limit=6000
2025-04-08 15:09:58,671 - task.stock_daily - INFO - 获取第2页数据，offset=6000, limit=6000
2025-04-08 15:09:59,476 - task.stock_daily - INFO - 获取第3页数据，offset=12000, limit=6000
2025-04-08 15:10:00,297 - task.stock_daily - INFO - 获取第4页数据，offset=18000, limit=6000
2025-04-08 15:10:01,083 - task.stock_daily - INFO - 获取第5页数据，offset=24000, limit=6000
2025-04-08 15:10:02,027 - task.stock_daily - INFO - 获取第6页数据，offset=30000, limit=6000
2025-04-08 15:10:02,988 - task.stock_daily - INFO - 获取第7页数据，offset=36000, limit=6000
2025-04-08 15:10:03,791 - task.stock_daily - INFO - 获取第8页数据，offset=42000, limit=6000
2025-04-08 15:10:04,622 - task.stock_daily - INFO - 获取第9页数据，offset=48000, limit=6000
2025-04-08 15:10:05,512 - task.stock_daily - INFO - 获取第10页数据，offset=54000, limit=6000
2025-04-08 15:10:06,932 - task.stock_daily - INFO - 获取第11页数据，offset=60000, limit=6000
2025-04-08 15:10:10,962 - task.stock_daily - INFO - 获取第12页数据，offset=66000, limit=6000
2025-04-08 15:10:12,371 - task.stock_daily - INFO - 获取第13页数据，offset=72000, limit=6000
2025-04-08 15:10:16,396 - task.stock_daily - INFO - 获取第14页数据，offset=78000, limit=6000
2025-04-08 15:10:17,426 - task.stock_daily - INFO - 获取第15页数据，offset=84000, limit=6000
2025-04-08 15:10:18,522 - task.stock_daily - INFO - 获取第16页数据，offset=90000, limit=6000
2025-04-08 15:10:19,576 - task.stock_daily - INFO - 获取第17页数据，offset=96000, limit=6000
2025-04-08 15:10:20,606 - task.stock_daily - INFO - 获取第18页数据，offset=102000, limit=6000
2025-04-08 15:10:21,625 - task.stock_daily - INFO - 获取第19页数据，offset=108000, limit=6000
2025-04-08 15:10:22,691 - task.stock_daily - INFO - 获取第20页数据，offset=114000, limit=6000
2025-04-08 15:10:23,844 - task.stock_daily - INFO - 获取第21页数据，offset=120000, limit=6000
2025-04-08 15:10:24,955 - task.stock_daily - INFO - 获取第22页数据，offset=126000, limit=6000
2025-04-08 15:10:49,669 - task.stock_daily - INFO - 获取第23页数据，offset=132000, limit=6000
2025-04-08 15:11:14,397 - task.stock_daily - INFO - 获取第24页数据，offset=138000, limit=6000
2025-04-08 16:25:20,853 - stock_data_example - INFO - 开始执行 stock_data_example (全量更新 stock_daily)...
2025-04-08 16:25:21,310 - db_manager - INFO - 数据库连接池创建成功
2025-04-08 16:25:21,310 - task.stock_daily - INFO - TushareAPI 客户端初始化成功
2025-04-08 16:25:21,310 - stock_data_example - INFO - 开始执行 StockDailyTask 全量更新 (所有股票)...
2025-04-08 16:25:21,310 - task.stock_daily - INFO - 开始执行stock_daily的全量更新...
2025-04-08 16:25:21,310 - task.stock_daily - INFO - 开始执行任务: stock_daily
2025-04-08 16:25:21,310 - task.stock_daily - INFO - 准备执行股票日线数据任务...
2025-04-08 16:25:21,310 - task.stock_daily - INFO - 获取数据，日期范围: None 至 None
2025-04-08 16:25:21,310 - task.stock_daily - INFO - 正在从Tushare获取数据，API: daily，参数: {'limit': 5000, 'page_interval': 0.05}
2025-04-08 16:25:21,312 - task.stock_daily - INFO - 获取第1页数据，offset=0, limit=5000
2025-04-08 16:25:21,932 - task.stock_daily - INFO - 获取第2页数据，offset=5000, limit=5000
2025-04-08 16:25:22,430 - task.stock_daily - INFO - 获取第3页数据，offset=10000, limit=5000
2025-04-08 16:25:22,947 - task.stock_daily - INFO - 获取第4页数据，offset=15000, limit=5000
2025-04-08 16:25:23,551 - task.stock_daily - INFO - 获取第5页数据，offset=20000, limit=5000
2025-04-08 16:25:24,145 - task.stock_daily - INFO - 获取第6页数据，offset=25000, limit=5000
2025-04-08 16:25:24,718 - task.stock_daily - INFO - 获取第7页数据，offset=30000, limit=5000
2025-04-08 16:25:25,312 - task.stock_daily - INFO - 获取第8页数据，offset=35000, limit=5000
2025-04-08 16:25:25,904 - task.stock_daily - INFO - 获取第9页数据，offset=40000, limit=5000
2025-04-08 16:25:26,538 - task.stock_daily - INFO - 获取第10页数据，offset=45000, limit=5000
2025-04-08 16:25:27,214 - task.stock_daily - INFO - 获取第11页数据，offset=50000, limit=5000
2025-04-08 16:25:27,865 - task.stock_daily - INFO - 获取第12页数据，offset=55000, limit=5000
2025-04-08 16:25:28,498 - task.stock_daily - INFO - 获取第13页数据，offset=60000, limit=5000
2025-04-08 16:25:29,193 - task.stock_daily - INFO - 获取第14页数据，offset=65000, limit=5000
2025-04-08 16:25:29,884 - task.stock_daily - INFO - 获取第15页数据，offset=70000, limit=5000
2025-04-08 16:25:30,571 - task.stock_daily - INFO - 获取第16页数据，offset=75000, limit=5000
2025-04-08 16:25:31,284 - task.stock_daily - INFO - 获取第17页数据，offset=80000, limit=5000
2025-04-08 16:25:32,000 - task.stock_daily - INFO - 获取第18页数据，offset=85000, limit=5000
2025-04-08 16:25:32,758 - task.stock_daily - INFO - 获取第19页数据，offset=90000, limit=5000
2025-04-08 16:25:33,580 - task.stock_daily - INFO - 获取第20页数据，offset=95000, limit=5000
2025-04-08 16:25:34,384 - task.stock_daily - INFO - 获取第21页数据，offset=100000, limit=5000
2025-04-08 16:25:35,193 - task.stock_daily - INFO - 获取第22页数据，offset=105000, limit=5000
2025-04-08 16:25:36,037 - task.stock_daily - INFO - 获取第23页数据，offset=110000, limit=5000
2025-04-08 16:25:36,893 - task.stock_daily - INFO - 获取第24页数据，offset=115000, limit=5000
2025-04-08 16:25:37,753 - task.stock_daily - INFO - 获取第25页数据，offset=120000, limit=5000
2025-04-08 16:25:38,615 - task.stock_daily - INFO - 获取第26页数据，offset=125000, limit=5000
2025-04-08 16:26:01,745 - task.stock_daily - INFO - 获取第27页数据，offset=130000, limit=5000
2025-04-08 16:26:25,585 - task.stock_daily - INFO - 获取第28页数据，offset=135000, limit=5000
2025-04-08 16:26:47,591 - task.stock_daily - INFO - 获取第29页数据，offset=140000, limit=5000
2025-04-08 16:27:09,673 - task.stock_daily - INFO - 获取第30页数据，offset=145000, limit=5000
2025-04-08 16:27:34,432 - task.stock_daily - INFO - 获取第31页数据，offset=150000, limit=5000
2025-04-08 16:27:58,241 - task.stock_daily - INFO - 获取第32页数据，offset=155000, limit=5000
2025-04-08 16:28:21,512 - task.stock_daily - INFO - 获取第33页数据，offset=160000, limit=5000
2025-04-08 16:28:44,886 - task.stock_daily - INFO - 获取第34页数据，offset=165000, limit=5000
2025-04-08 16:28:59,844 - db_manager - INFO - 数据库连接池已关闭
2025-04-08 16:28:59,844 - stock_data_example - INFO - 数据库连接已关闭。
2025-04-08 16:28:59,844 - stock_data_example - INFO - stock_data_example 执行完毕。总耗时: 0:03:38.991174
